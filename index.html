<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DecideForMe - IA Real</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: system-ui;
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
        }
        h1 { color: #667eea; margin-bottom: 10px; font-size: 2.5em; }
        .subtitle { color: #666; margin-bottom: 30px; }
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin-bottom: 15px;
            font-size: 16px;
        }
        input:focus { outline: 0; border-color: #667eea; }
        button {
            width: 100%;
            padding: 15px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 700;
        }
        button:hover { transform: translateY(-2px); }
        #result {
            margin: 20px 0;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
            border-left: 5px solid #667eea;
        }
        #result h3 { color: #667eea; margin-bottom: 15px; }
        #decision { font-size: 1.1em; line-height: 1.6; }
        .feedback { display: flex; gap: 15px; margin-top: 20px; }
        .feedback button { width: auto; padding: 10px 25px; }
        .thumbs-up { background: linear-gradient(135deg, #11998e, #38ef7d); }
        .thumbs-down { background: linear-gradient(135deg, #eb3349, #f45c43); }
        .disclaimer { text-align: center; color: #999; margin-top: 20px; font-size: .9em; }
        #history { margin-top: 40px; }
        #history h3 { color: #667eea; margin-bottom: 15px; }
        .history-item {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
        }
        .history-item small { color: #999; display: block; margin-bottom: 8px; }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <h1> DecideForMe</h1>
        <p class="subtitle">Elimina la par谩lisis de decisi贸n en 3 segundos</p>
        <input id="context" placeholder="Opcional: presupuesto, tiempo, preferencias...">
        <button onclick="decide()">DECIDIR POR M</button>
        <div id="result">
            <h3>Tu decisi贸n:</h3>
            <p id="decision"></p>
            <div class="feedback">
                <button class="thumbs-up" onclick="feedback('up')"> Me gust贸</button>
                <button class="thumbs-down" onclick="feedback('down')"> No me gust贸</button>
            </div>
        </div>
        
        <div id="history">
            <h3>Historial</h3>
            <div id="historyList"></div>
        </div>
    </div>

    <script>
        async function decide() {
            const context = document.getElementById('context').value;
            const resultDiv = document.getElementById('result');
            const decisionP = document.getElementById('decision');
            
            decisionP.innerHTML = '<span class="loading"></span> Pensando...';
            resultDiv.style.display = 'block';
            
            try {
                const response = await fetch('/api/decide', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ context })
                });
                
                const data = await response.json();
                decisionP.textContent = data.decision;
                saveHistory(data.decision);
            } catch (error) {
                decisionP.textContent = 'Error al generar decisi贸n. Intenta de nuevo.';
                console.error(error);
            }
        }
        
        function feedback(type) {
            const feedbacks = JSON.parse(localStorage.getItem('feedbacks') || '[]');
            feedbacks.push({
                type,
                decision: document.getElementById('decision').textContent,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('feedbacks', JSON.stringify(feedbacks));
            alert(type === 'up' ? '隆Genial! ' : 'Entendido ');
        }
        
        function saveHistory(decision) {
            const history = JSON.parse(localStorage.getItem('history') || '[]');
            history.unshift({
                decision,
                timestamp: new Date().toLocaleString()
            });
            if (history.length > 10) history.pop();
            localStorage.setItem('history', JSON.stringify(history));
            displayHistory();
        }
        
        function displayHistory() {
            const history = JSON.parse(localStorage.getItem('history') || '[]');
            document.getElementById('historyList').innerHTML = history
                .map(h => `<div class="history-item"><small>${h.timestamp}</small>${h.decision}</div>`)
                .join('') || '<p style="color: #999">Sin historial a煤n</p>';
        }
        
        displayHistory();
    </script>
</body>
</html>
